# ?????????logistic??????????????????????????????
model1 <- glm(y~., data=train_set, family='binomial')
pre <- predict(model1,type='response')
# ???????????????prob???????????????y????????????????????????
data <- data.frame(prob=pre,obs=train_set$y)
# ?????????????????????????????????
data <- data[order(data$prob),]
n <- nrow(data)
tpr <- fpr <- rep(0,n)
# ????????????????????????threshold?????????TPR???FPR?????????????????????
for (i in 1:n) {
  threshold <- data$prob[i]
  tp <- sum(data$prob > threshold & data$obs == 1)
  fp <- sum(data$prob > threshold & data$obs == 0)
  tn <- sum(data$prob < threshold & data$obs == 0)
  fn <- sum(data$prob < threshold & data$obs == 1)
  tpr[i] <- tp/(tp+fn) # ?????????
  fpr[i] <- fp/(tn+fp) # ?????????
}
plot(fpr,tpr,type='l')
abline(a=0,b=1)

library(ROCR)
pred <- prediction(as.numeric(predictions_rf)-1,test_set$y)
performance(as.numeric(predictions_rf)-1,'auc')@y.values
perf <- performance(pred,'tpr','fpr')
plot(perf)

library(pROC)
modelroc <- roc(test_set$y,as.numeric(predictions_rf)-1)
plot(modelroc, print.auc=TRUE, auc.polygon=TRUE, grid=c(0.1, 0.2),
     grid.col=c("green", "red"), max.auc.polygon=TRUE,
     auc.polygon.col="skyblue", print.thres=TRUE)
